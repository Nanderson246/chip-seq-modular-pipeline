{"title":"Overview","markdown":{"yaml":{"title":"Overview"},"headingText":"🧬 Overview","containsRefs":false,"markdown":"\n\n\nThis pipeline was developed and tested on Linux with POSIX-compliant behavior, macOS compatibility is not supported, If adjustments are needed for your system, you are free to modify the setup accordingly. This is the first version and still in beta test. However you can download and tested in your system as full package or use every modular script. The goal was to create a first Github project to establish Bioinformatic competence by the author.\n\nThis project implements a modular and reproducible **ChIP-seq analysis pipeline** designed for both human and mouse samples. The pipeline is organized into two main parts:\n\n1.  **Preprocessing and BAM Cleaning** – Modular pipeline for data preparation.\n2.  **Peak Calling and Reproducibility Analysis** – Peak detection, quality control, and IDR-based reproducibility assessment.\n\nThe pipeline supports both **HOMER** and **MACS3** workflows, and uses metadata-based automation. Its structure mirrors the **ENCODE ChIP-seq processing pipeline**, providing a modular, standardized workflow to produce reproducible peak calls, generate signal tracks, and perform quality assessments such as IDR (Irreproducible Discovery Rate), while automating sample naming and grouping.\n\nThis package is intended to be flexible and modular. Each module can be customized by the user, or the pipeline can be run as-is. It is **not a beginner-friendly pipeline**, nor was it designed to be. The pipeline runs directly in Bash on a Linux system. Docker files are included to allow execution within containers, and a brief guide is provided at the end of this text, explaining how to build the container and mount the required folders properly.\n\nTo run this pipeline you will need to have your paired fastq.gz samples in the samples folder, a mapping.tsv data, and to set the reference files in the Reference folder and the spike reference genomes in the SpikeinReference folder.\n\nThe package provide two dataset test from GEO dataset to test Hg38 and mm10 samples.\n\nInformation about these two GEO datasets is provided in the README.md file inside the examples/ folder. The pipeline1 is adapted to automatically download an SRR_Acc_List.txt if the list in the metadata folder. We also provide the mapping.tsv as example\n\n------------------------------------------------------------------------\n\n## 📚 Pipeline Components\n\n### 🔧 1. **Read Preprocessing and Alignment**\n\n**Input:** FASTQ files (`reads`)\n\n**Tools Used:**\n\n-   `cutadapt`: Adapter trimming\n-   `BWA`: Alignment to reference genome\n-   `Samtools`, `Picard`: Sorting, deduplication, indexing, BAM cleanup\n\n**Outputs:**\n\n-   Unfiltered alignments\n-   Filtered, deduplicated BAM files\n-   Removal of excluded/blacklisted regions (e.g., ENCODE blacklist)\n\n------------------------------------------------------------------------\n\n## 🔬 Replicate Quality Control with **deepTools**\n\nThis pipeline uses **deepTools** (e.g., `plotFingerprint`, `multiBamSummary`) to evaluate replicate quality.\n\n### ✅ Advantages of deepTools:\n\n-   🧪 **Modern and actively maintained** – compatible with recent Python environments\n-   📊 **Fingerprint and cross-correlation plots** – assess ChIP enrichment and background\n-   ⚙️ **Format flexibility** – supports BAM and BigWig\n-   🐳 **Container-friendly** – easy to integrate in Docker-based workflows\n-   📁 **Multi-sample analysis** – supports `multiBamSummary`, `plotCorrelation`\n\nUsers can optionally replace this with **Relative Strand Correlation (RSC)** via the **ChIPQC R package** by editing the relevant module — showcasing the pipeline's modularity.\n\n------------------------------------------------------------------------\n\n### ❓ Why not use `phantompeakqualtools`?\n\nAlthough once widely used to assess replicate quality, `phantompeakqualtools` is now:\n\n-   🛑 Outdated and no longer actively maintained\n-   🐪 Depends on legacy Perl environments and outdated tools like CClang v5\n-   🧱 Hard to containerize or integrate into modern pipelines\n\nTherefore, it has been replaced by more maintainable alternatives in this workflow.\n\n------------------------------------------------------------------------\n\n### 📈 2. **Signal Generation**\n\n**Tools:**\n\n-   MACS3: Generates signal tracks (bedGraph or bigWig)\n-   BEDTools: For further manipulation\n\n**Outputs:**\n\n-   Signal p-value tracks\n-   Fold change over control tracks\n\n------------------------------------------------------------------------\n\n### 📍 3. **Peak Calling**\n\n**Performed on:**\n\n-   Individual replicates\n-   Pooled replicates\n-   Pseudoreplicates\n\n**Tools:**\n\n-   MACS3 or HOMER\n\n**Outputs:**\n\n-   Replicated peaks\n-   Pooled peaks\n-   Pseudoreplicated peaks\n\n------------------------------------------------------------------------\n\n### 📊 4. **IDR Analysis**\n\n**Tool:** [`idr`](https://github.com/nboley/idr) — used to assess peak reproducibility\n\nThis pipeline uses a **patched IDR version** compatible with the latest `numpy`, avoiding the need to downgrade.\n\n------------------------------------------------------------------------\n\n### 🛠 Patch + Install IDR (NumPy Compatibility)\n\n```         \nbash\n    wget https://github.com/kundajelab/idr/archive/refs/tags/2.0.4.2.tar.gz && \\\n    tar -xvf 2.0.4.2.tar.gz && \\\n    cd idr-2.0.4.2/idr && \\\n    sed -i 's/numpy.int/int/g' idr.py && \\\n    cd .. && \\\n    pip install . --break-system-packages && \\\n    rm -rf /opt/idr-2.0.4.2 /opt/2.0.4.2.tar.gz\n```\n\n**Outputs:**\n\n-   IDR-ranked peaks\n-   IDR-thresholded peaks\n-   Conservative IDR peaks\n\n------------------------------------------------------------------------\n\n### 🔁 5. **Replicate/Partition Concordance**\n\nAssesses consistency of peaks across replicates and pseudoreplicates.\n\n------------------------------------------------------------------------\n\n### 🧾 6. **Format Conversion and Final Outputs**\n\nCovers conversion to final formats for visualization, downstream analysis, or submission.\n\n------------------------------------------------------------------------\n\n","srcMarkdownNoYaml":"\n\n## 🧬 Overview\n\nThis pipeline was developed and tested on Linux with POSIX-compliant behavior, macOS compatibility is not supported, If adjustments are needed for your system, you are free to modify the setup accordingly. This is the first version and still in beta test. However you can download and tested in your system as full package or use every modular script. The goal was to create a first Github project to establish Bioinformatic competence by the author.\n\nThis project implements a modular and reproducible **ChIP-seq analysis pipeline** designed for both human and mouse samples. The pipeline is organized into two main parts:\n\n1.  **Preprocessing and BAM Cleaning** – Modular pipeline for data preparation.\n2.  **Peak Calling and Reproducibility Analysis** – Peak detection, quality control, and IDR-based reproducibility assessment.\n\nThe pipeline supports both **HOMER** and **MACS3** workflows, and uses metadata-based automation. Its structure mirrors the **ENCODE ChIP-seq processing pipeline**, providing a modular, standardized workflow to produce reproducible peak calls, generate signal tracks, and perform quality assessments such as IDR (Irreproducible Discovery Rate), while automating sample naming and grouping.\n\nThis package is intended to be flexible and modular. Each module can be customized by the user, or the pipeline can be run as-is. It is **not a beginner-friendly pipeline**, nor was it designed to be. The pipeline runs directly in Bash on a Linux system. Docker files are included to allow execution within containers, and a brief guide is provided at the end of this text, explaining how to build the container and mount the required folders properly.\n\nTo run this pipeline you will need to have your paired fastq.gz samples in the samples folder, a mapping.tsv data, and to set the reference files in the Reference folder and the spike reference genomes in the SpikeinReference folder.\n\nThe package provide two dataset test from GEO dataset to test Hg38 and mm10 samples.\n\nInformation about these two GEO datasets is provided in the README.md file inside the examples/ folder. The pipeline1 is adapted to automatically download an SRR_Acc_List.txt if the list in the metadata folder. We also provide the mapping.tsv as example\n\n------------------------------------------------------------------------\n\n## 📚 Pipeline Components\n\n### 🔧 1. **Read Preprocessing and Alignment**\n\n**Input:** FASTQ files (`reads`)\n\n**Tools Used:**\n\n-   `cutadapt`: Adapter trimming\n-   `BWA`: Alignment to reference genome\n-   `Samtools`, `Picard`: Sorting, deduplication, indexing, BAM cleanup\n\n**Outputs:**\n\n-   Unfiltered alignments\n-   Filtered, deduplicated BAM files\n-   Removal of excluded/blacklisted regions (e.g., ENCODE blacklist)\n\n------------------------------------------------------------------------\n\n## 🔬 Replicate Quality Control with **deepTools**\n\nThis pipeline uses **deepTools** (e.g., `plotFingerprint`, `multiBamSummary`) to evaluate replicate quality.\n\n### ✅ Advantages of deepTools:\n\n-   🧪 **Modern and actively maintained** – compatible with recent Python environments\n-   📊 **Fingerprint and cross-correlation plots** – assess ChIP enrichment and background\n-   ⚙️ **Format flexibility** – supports BAM and BigWig\n-   🐳 **Container-friendly** – easy to integrate in Docker-based workflows\n-   📁 **Multi-sample analysis** – supports `multiBamSummary`, `plotCorrelation`\n\nUsers can optionally replace this with **Relative Strand Correlation (RSC)** via the **ChIPQC R package** by editing the relevant module — showcasing the pipeline's modularity.\n\n------------------------------------------------------------------------\n\n### ❓ Why not use `phantompeakqualtools`?\n\nAlthough once widely used to assess replicate quality, `phantompeakqualtools` is now:\n\n-   🛑 Outdated and no longer actively maintained\n-   🐪 Depends on legacy Perl environments and outdated tools like CClang v5\n-   🧱 Hard to containerize or integrate into modern pipelines\n\nTherefore, it has been replaced by more maintainable alternatives in this workflow.\n\n------------------------------------------------------------------------\n\n### 📈 2. **Signal Generation**\n\n**Tools:**\n\n-   MACS3: Generates signal tracks (bedGraph or bigWig)\n-   BEDTools: For further manipulation\n\n**Outputs:**\n\n-   Signal p-value tracks\n-   Fold change over control tracks\n\n------------------------------------------------------------------------\n\n### 📍 3. **Peak Calling**\n\n**Performed on:**\n\n-   Individual replicates\n-   Pooled replicates\n-   Pseudoreplicates\n\n**Tools:**\n\n-   MACS3 or HOMER\n\n**Outputs:**\n\n-   Replicated peaks\n-   Pooled peaks\n-   Pseudoreplicated peaks\n\n------------------------------------------------------------------------\n\n### 📊 4. **IDR Analysis**\n\n**Tool:** [`idr`](https://github.com/nboley/idr) — used to assess peak reproducibility\n\nThis pipeline uses a **patched IDR version** compatible with the latest `numpy`, avoiding the need to downgrade.\n\n------------------------------------------------------------------------\n\n### 🛠 Patch + Install IDR (NumPy Compatibility)\n\n```         \nbash\n    wget https://github.com/kundajelab/idr/archive/refs/tags/2.0.4.2.tar.gz && \\\n    tar -xvf 2.0.4.2.tar.gz && \\\n    cd idr-2.0.4.2/idr && \\\n    sed -i 's/numpy.int/int/g' idr.py && \\\n    cd .. && \\\n    pip install . --break-system-packages && \\\n    rm -rf /opt/idr-2.0.4.2 /opt/2.0.4.2.tar.gz\n```\n\n**Outputs:**\n\n-   IDR-ranked peaks\n-   IDR-thresholded peaks\n-   Conservative IDR peaks\n\n------------------------------------------------------------------------\n\n### 🔁 5. **Replicate/Partition Concordance**\n\nAssesses consistency of peaks across replicates and pseudoreplicates.\n\n------------------------------------------------------------------------\n\n### 🧾 6. **Format Conversion and Final Outputs**\n\nCovers conversion to final formats for visualization, downstream analysis, or submission.\n\n------------------------------------------------------------------------\n\n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":false,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"ipynb-shell-interactivity":null,"plotly-connected":true,"engine":"markdown"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":false,"code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-min-runs":1,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","toc":true,"toc-depth":3,"number-sections":true,"css":["styles.css"],"output-file":"overview.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","appendix-view-license":"View License","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","tools-share":"Share","tools-download":"Download","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-text-placeholder":"","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words","listing-page-filter":"Filter","draft":"Draft"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.7.32","theme":"cerulean","title":"Overview"},"extensions":{"book":{"multiFile":true}}}},"projectFormats":["html"]}